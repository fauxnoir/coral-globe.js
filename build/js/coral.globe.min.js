var Coral;Coral=Coral||{},Coral.Globe=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t;for(r=function(a){return a*a},b=.35,o=new THREE.Object3D,a=[8833462,7778960,9488792,8499830,10797954],g={smoothing:15,detail:4,radius:.5,noiseOptions:{amplitude:1,frequency:1.5,octaves:1,persistence:.5}},d=Coral.Blob(g),l=new THREE.MeshPhongMaterial({color:random(a),shading:THREE.FlatShading}),k=new THREE.Mesh(d,l),n={amplitude:1,frequency:2.5,octaves:1,persistence:.5},e=new FastSimplexNoise(n),console.assert(null!=d.vertices),f=[],m=[],q=d.vertices,h=i=0,j=q.length;j>i;h=++i)s=q[h],c=e.get3DNoise(s.x,s.y,s.z),c>b&&(p={smoothing:3,radius:Math.random()/35,detail:1,noiseOptions:{amplitude:1,frequency:30,octaves:1,persistence:.5}},Math.random()>.75?(f[h]=Coral.Blob(p),m[h]=new THREE.Mesh(f[h],l)):(f[h]=new THREE.BoxGeometry(.015,.2,.015),m[h]=new THREE.Mesh(f[h],l)),m[h].position.set(s.x,s.y,s.z),t=new THREE.Vector3(s.x,s.y,s.z),Coral.Globe.Orient(t,m[h]),m[h].castShadow=!0,m[h].receiveShadow=!0,o.add(m[h]));return o.add(k)},Coral.Globe.Orient=function(a,b){var c,d,e;return e=new THREE.Vector3(1,1,0),this.unit_y=new THREE.Vector3(0,1,0),c=new THREE.Vector3(a.x,a.y,a.z),d=new THREE.Vector3,d.multiplyVectors(c,e),c.x>0&&c.y>0||c.x>0&&c.y<0?this.theta=2*Math.PI-this.unit_y.angleTo(d):this.theta=this.unit_y.angleTo(d),this.phi=new THREE.Vector3,c.z>0?this.phi=d.angleTo(c):this.phi=-d.angleTo(c),b.rotation.set(this.phi,0,this.theta,"ZXY")};