var Coral;Coral=Coral||{},Coral.Globe=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u;for(s=function(a){return a*a},b=.17,p=new THREE.Object3D,a=[8833462,7778960,9488792,8499830,10797954,7163699],g={smoothing:20,detail:4,radius:.5,noiseOptions:{amplitude:1,frequency:1.5,octaves:1,persistence:.5}},d=Coral.Blob(g),m=new THREE.MeshPhongMaterial({color:random(a),shading:THREE.FlatShading}),k=new THREE.Mesh(d,m),o={amplitude:1,frequency:2.5,octaves:1,persistence:.5},e=new FastSimplexNoise(o),console.assert(null!=d.vertices),f=[],n=[],r=d.vertices,h=i=0,j=r.length;j>i;h=++i)t=r[h],c=e.get3DNoise(t.x,t.y,t.z),c>b&&(q={smoothing:3,radius:1,detail:1,noiseOptions:{amplitude:1,frequency:30,octaves:1,persistence:.5}},Math.random()>.9?(f[h]=Coral.Blob(q),l=new THREE.MeshPhongMaterial({color:10132900,shading:THREE.FlatShading}),n[h]=new THREE.Mesh(f[h],l),n[h].scale.set(.005,.005,.005),n[h].position.set(t.x,t.y+.01,t.z)):Math.random()>.5&&(n[h]=Coral.Tree(),n[h].scale.set(.1,.1,.1),n[h].position.set(t.x,t.y+.04,t.z)),null!=n[h]&&(u=new THREE.Vector3(t.x,t.y,t.z),Coral.Globe.Orient(u,n[h]),n[h].castShadow=!0,n[h].receiveShadow=!0,p.add(n[h])));return p.add(k)},Coral.Globe.Orient=function(a,b){var c,d,e;return e=new THREE.Vector3(1,1,0),this.unit_y=new THREE.Vector3(0,1,0),c=new THREE.Vector3(a.x,a.y,a.z),d=new THREE.Vector3,d.multiplyVectors(c,e),c.x>0&&c.y>0||c.x>0&&c.y<0?this.theta=2*Math.PI-this.unit_y.angleTo(d):this.theta=this.unit_y.angleTo(d),this.phi=new THREE.Vector3,c.z>0?this.phi=d.angleTo(c):this.phi=-d.angleTo(c),b.rotation.set(this.phi,0,this.theta,"ZXY")};